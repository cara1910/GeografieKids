@model GeografieKids.Models.IntrebareHarta

@{
    ViewBag.Title = "Test Harta America";
}

<main class="full-screen-view text-center">
    <h2 class="mb-4">Unde este <strong>@Model.NumeTara</strong>?</h2>

    <div id="svgContainer">
        @Html.Raw(System.IO.File.ReadAllText(Server.MapPath("~/Content/img/america.svg")))
    </div>

    <div id="mesaj" class="mt-3 fs-4"></div>
</main>

@section Scripts {
    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const tari = document.querySelectorAll("svg [id]");
        tari.forEach(tara => {
            tara.style.cursor = "pointer";
            tara.addEventListener("click", function () {
                verificaRaspuns(tara.id);
            });
        });
    });

    function verificaRaspuns(idSelectat) {
        fetch('@Url.Action("VerificaRaspuns", "Test")', {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ codSvgSelectat: idSelectat })
        })
        .then(res => res.json())
        .then(data => {
            coloreazaZona(idSelectat, data.corect);
            setTimeout(() => {
                location.reload();
            }, 1500);
        });
    }

    function coloreazaZona(id, corect) {
        const el = document.getElementById(id);
        if (el) {
            el.style.fill = corect ? "green" : "red";
        }
        document.getElementById("mesaj").innerText = corect ? "Corect!" : "Gresit!";
    }
    </script>
}
